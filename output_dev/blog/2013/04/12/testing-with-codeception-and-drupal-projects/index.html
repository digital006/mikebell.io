<!DOCTYPE html>
<html>
    <head>
        <title>Testing with Codeception and Drupal Projects &mdash; Sculpin Blog Skeleton &mdash; To Get You Started</title>
        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta name="robots" content="index, follow">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <link rel="apple-touch-startup-image" href="/images/jackson/2048x2048.png">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="shortcut icon" sizes="76x76" href="/images/jackson/76x76.png">
        <link rel="shortcut icon" sizes="120x120" href="/images/jackson/120x120.png">
        <link rel="shortcut icon" sizes="128x128" href="/images/jackson/128x128.png">
        <link rel="shortcut icon" sizes="152x152" href="/images/jackson/152x152.png">
        <link rel="shortcut icon" sizes="196x196" href="/images/jackson/196x196.png">
        <link rel="shortcut icon" sizes="512x512" href="/images/jackson/512x512.png">
        <link rel="shortcut icon" sizes="1024x1024" href="/images/jackson/1024x1024.png">
        <link rel="shortcut icon" sizes="2048x2048" href="/images/jackson/2048x2048.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/images/jackson/76x76.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/images/jackson/120x120.png">
        <link rel="apple-touch-icon" sizes="128x128" href="/images/jackson/128x128.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/images/jackson/152x152.png">
        <link rel="apple-touch-icon" sizes="196x196" href="/images/jackson/196x196.png">
        <link rel="apple-touch-icon" sizes="512x512" href="/images/jackson/512x512.png">
        <link rel="apple-touch-icon" sizes="1024x1024" href="/images/jackson/1024x1024.png">
        <link rel="apple-touch-icon" sizes="2048x2048" href="/images/jackson/2048x2048.png">

        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Sculpin Blog Skeleton activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
                                    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">Sculpin Blog Skeleton</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/blog/categories">Categories</a></li>
                                <li><a href="/blog/tags">Tags</a></li>
                                <li><a href="/about">About</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2>Testing with Codeception and Drupal Projects <small>post</small></h2>
        </header>
        <div>
            <p>As part of my increased like of agile development and the control it gives you over your estimates and deliverables I've become increasingly aware of the horrible fact our code coverage sucks. There's no real way to sugar coat it we don't do proper testing, it's bugged me for years.</p>

<h2 id="technical-debt">Technical Debt</h2>

<p>I first read of technical debt over 5 years at my previous job, the basics of technical debt are that every hack/bodge job will bite you in the ass and you will spend more time fixing things in the long run that implementing it correctly. Now this is where agile comes in, with better estimations it allows you to factor in more unknowns, break down user stories into smaller more achievable tasks and ultimately give you a higher level of what is to be achieved.</p>

<h2 id="with-smaller-tasks-comes-great-responsibility">With smaller tasks comes great responsibility</h2>

<p>When you break down each user story into a task it gives you a clear set of deliverables, now both the user and developer are clear on what needs to be achieved. Now with this method there's no more "that was way too ambiguous", you should now exactly what has to be delivered. So on completion of that test how do you confidently say it's complete? There are two ways:</p>

<ol>
<li>Suck it and see, mark task as complete and let client figure it out</li>
<li>Test the thing and test it hard and repeatedly.</li>
</ol>

<h2 id="over-and-over-and-over-and-over-again">Over and over and over and over again</h2>

<p>So now you know what you have to deliver, you should test it. Here's where codeception comes in, it's a framework that allows you to quickly (and I mean quickly!) write acceptance testing for you application. It also integrates with other types of testing (e.g. unit tests) but lets start small.</p>

<p>With each task you should always create a test, each test should actually test functionality, remember don't test for the sake of it!</p>

<h2 id="getting-down-to-it">Getting down to it</h2>

<ol>
<li>Install it - http://codeception.com/install</li>
<li>Create your fist acceptance test:
 <code>php codecept.phar generate:cept acceptance DrupalUserLogin</code></li>
<li><p>Write your first test:
<code>
$I = new WebGuy($scenario);
$I->wantTo('Ensure Drupal Login Works');
$I->amOnPage('/user');
$I->fillField('edit-name', 'digital');
$I->fillField('edit-pass', 'THIS IS MY REAL PASS');
$I->click('edit-submit');
$I->see('digital');</code></p></li>
<li><p>Define your site (tests/acceptance.suite.yml):</p></li>
</ol>

<p><code>
class_name: WebGuy
modules:
    enabled: [PhpBrowser, WebHelper]
    config:
        PhpBrowser:
            url: 'drupal.org'</code></p>

<ol start="5">
<li>Run the badger! - <code>php codecept.phar run</code></li>
<li>Bask in the glory of your first test.</li>
</ol>

<p>There it is, dead easy to do! There's no reason you shouldn't implement this for every task in your sprint backlog.</p>

<h2 id="where-to-go-from-here%3F">Where to go from here?</h2>

<p>After playing around with this for a few hours I seem to be doing the same thing. Each test requires me to login as I don't think each test environment shares session/cookies. I need to figure out a way of creating a codeception module which allows you to plug in a drupal testing user (ideally multiple so you can test each role) and then all the you have to do is call a function which executes the above steps to confirm your logged in before testing authenticated behaviour.</p>

<p>Something along the lines of:</p>

<p><code>$I->drupalLogin('editor');</code></p>

<h2 id="why-will-this-work%3F">Why will this work?</h2>

<p>When you initially set out estimation of each story you should add an extra 5-10% for testing. This way you can cover the additional time taken to write these tests. Trust me it's worth it in the long run!</p>

<h2 id="update-20%2F05%2F13">Update 20/05/13</h2>

<p>My colleague Paul Byrne has posted a second part to this article with more information - http://paul.leafish.co.uk/articles/code/more_testing_with_codeception_and_drupal_projects - Check it out.</p>

        </div>
                            <p class="tags">
            Tags:
                        <a href="/blog/tags/Drupal">Drupal</a>,                         <a href="/blog/tags/Drupal%20Planet">Drupal Planet</a>                        </p>
        
                    <nav class="article">
                <ul>
                                            <li>Next: <a class="next" href="/blog/2013/04/17/webinar-is-a-dirty-word" title="Webinar is a dirty word"><span class="title">Webinar is a dirty word</span></a></li>
                                                                <li>Previous: <a class="previous" href="/blog/2013/03/30/we-went-big" title="We Went Big..."><span class="title">We Went Big...</span></a></li>
                                    </ul>
            </nav>
            </article>



                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>Sculpin Blog Skeleton <small>To Get You Started</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <h4>Links</h4>
                        <ul class="nav">
                            <li><a href="http://sculpin.io">sculpin.io</a></li>
                            <li><a href="http://twitter.com/getsculpin">@getsculpin</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2015 Sculpin Blog Skeleton
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

                    </body>
</html>
