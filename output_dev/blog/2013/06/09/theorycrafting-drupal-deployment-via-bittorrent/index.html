<!DOCTYPE html>
<html>
    <head>
        <title>Theorycrafting Drupal Deployment Via Bittorrent &mdash; Sculpin Blog Skeleton &mdash; To Get You Started</title>
        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta name="robots" content="index, follow">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <link rel="apple-touch-startup-image" href="/images/jackson/2048x2048.png">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="shortcut icon" sizes="76x76" href="/images/jackson/76x76.png">
        <link rel="shortcut icon" sizes="120x120" href="/images/jackson/120x120.png">
        <link rel="shortcut icon" sizes="128x128" href="/images/jackson/128x128.png">
        <link rel="shortcut icon" sizes="152x152" href="/images/jackson/152x152.png">
        <link rel="shortcut icon" sizes="196x196" href="/images/jackson/196x196.png">
        <link rel="shortcut icon" sizes="512x512" href="/images/jackson/512x512.png">
        <link rel="shortcut icon" sizes="1024x1024" href="/images/jackson/1024x1024.png">
        <link rel="shortcut icon" sizes="2048x2048" href="/images/jackson/2048x2048.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/images/jackson/76x76.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/images/jackson/120x120.png">
        <link rel="apple-touch-icon" sizes="128x128" href="/images/jackson/128x128.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/images/jackson/152x152.png">
        <link rel="apple-touch-icon" sizes="196x196" href="/images/jackson/196x196.png">
        <link rel="apple-touch-icon" sizes="512x512" href="/images/jackson/512x512.png">
        <link rel="apple-touch-icon" sizes="1024x1024" href="/images/jackson/1024x1024.png">
        <link rel="apple-touch-icon" sizes="2048x2048" href="/images/jackson/2048x2048.png">

        <link rel="stylesheet" href="/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Sculpin Blog Skeleton activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
                                    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/">Sculpin Blog Skeleton</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/blog">Posts Archive</a></li>
                                <li><a href="/blog/categories">Categories</a></li>
                                <li><a href="/blog/tags">Tags</a></li>
                                <li><a href="/about">About</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2>Theorycrafting Drupal Deployment Via Bittorrent <small>post</small></h2>
        </header>
        <div>
            <p>There was an article floating around a few weeks ago about deploying large scale applications to multiple servers through bittorrent. I remember being at a talk by a Facebook developer who mentioned they did the same. I figured I'd put some thought into how it could be done at a practical level for Drupal sites.</p>

<p>Tools Needed:</p>

<ol>
<li>Jenkins - http://jenkins-ci.org/</li>
<li>mktorrent - http://mktorrent.sourceforge.net/</li>
<li>rtorrent/libtorrent - http://libtorrent.rakshasa.no/</li>
<li>ocelot/gazelle - https://what.cd/gazelle/</li>
</ol>

<h2 id="jenkins">Jenkins</h2>

<p>Jenkins can be used to tie all the separate tools together.</p>

<h2 id="mktorrent">mktorrent</h2>

<p>A cli tool to build .torrent files which can be pushed off to remote servers. This can integrate with Jenkins to build the torrent based of Jenkins variables.</p>

<h2 id="rtorrent%2Flibtorrent">rtorrent/libtorrent</h2>

<p>This is a command line torrent client, it can be setup to watch from a directory on the remote server. It then starts downloading files once a new torrent is places into the watch directory.</p>

<h2 id="ocelot%2Fgazelle">Ocelot/Gazelle</h2>

<p>High performance bittorrent tracker and web front end. This can be used to manage connections between all your web front ends.</p>

<h2 id="sample-workflow">Sample Workflow</h2>

<ol>
<li>Developer pushes code to specific git branch</li>
<li>Jenkins fires a build to pull down the latest code (Build 1)</li>
<li>After Build 1 finishes mktorrent runs to package a .torrent file (Build 2)</li>
<li>Torrent file is published to Gazelle (Build 2)</li>
<li>After Build 2 finishes torrent file is pushed to all remote servers</li>
<li>Each rtorrent instances starts download of files</li>
</ol>

<h2 id="issues">Issues</h2>

<p>Things become a bit complex once the files have been distributed via torrents, my main concern would be how to reliably switch over to the new files once the download has completed. rtorrent does have the ability to issue commands once a download has finished but I'm unsure whether it could potentially run an external script.</p>

<p>Drupal is small (averaging 16-30mb for a normal site Drupal 7) so bittorrent isn't the most effective method of distributing a codebase.</p>

<h2 id="benefits">Benefits</h2>

<p>Error Detections - Ability to reliably say you have exactly what's expected
Speed - All web server will be providing upstream so in theory the only slow part will be disk IO and downstream connection.</p>

<p>Overall this is an interesting thought experiment would quite like to try it out one day.</p>

        </div>
                            <p class="tags">
            Tags:
                        <a href="/blog/tags/Drupal">Drupal</a>                        </p>
        
                    <nav class="article">
                <ul>
                                            <li>Next: <a class="next" href="/blog/2013/07/16/git-just-fucking-get-on-with-it" title="Git just fucking get on with it."><span class="title">Git just fucking get on with it.</span></a></li>
                                                                <li>Previous: <a class="previous" href="/blog/2013/05/27/better-and-smarter-notifications" title="Better and Smarter Notifications"><span class="title">Better and Smarter Notifications</span></a></li>
                                    </ul>
            </nav>
            </article>



                </div>
                <div class="span4 sidebar">
                    <div class="well">
                        <h4>Sculpin Blog Skeleton <small>To Get You Started</small></h4>
                    </div>
                    <div class="well sidebar-nav">
                        <h4>Links</h4>
                        <ul class="nav">
                            <li><a href="http://sculpin.io">sculpin.io</a></li>
                            <li><a href="http://twitter.com/getsculpin">@getsculpin</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2015 Sculpin Blog Skeleton
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

                    </body>
</html>
